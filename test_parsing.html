<!DOCTYPE html>
<html>
<head>
    <title>Test Excel Parsing</title>
</head>
<body>
    <h1>Excel Time Parsing Test</h1>
    <div id="output"></div>
    
    <script>
        // Day name mapping
        const dayMapping = {
            'Mo': 'Monday',
            'Tu': 'Tuesday', 
            'We': 'Wednesday',
            'Th': 'Thursday',
            'Fr': 'Friday'
        };
        
        // Parse Excel time format like "Fr 13 - 16" or "Mo 12 - 15 Th 17 - 18"
        function parseExcelTime(timeString) {
            console.log('Parsing timeString:', timeString);
            if (!timeString) return [];
            
            const timeSlots = [];
            // Split by multiple spaces or find patterns like "Day Hour - Hour"
            const patterns = timeString.match(/[A-Za-z]{2}\s+\d{1,2}\s*-\s*\d{1,2}/g);
            console.log('Found patterns:', patterns);
            
            if (patterns) {
                patterns.forEach(pattern => {
                    const match = pattern.match(/([A-Za-z]{2})\s+(\d{1,2})\s*-\s*(\d{1,2})/);
                    if (match) {
                        const [, dayAbbr, startHour, endHour] = match;
                        const fullDay = dayMapping[dayAbbr];
                        console.log('Match found:', {dayAbbr, startHour, endHour, fullDay});
                        if (fullDay) {
                            timeSlots.push({
                                Day: fullDay,
                                StartHour: parseInt(startHour),
                                EndHour: parseInt(endHour)
                            });
                        }
                    }
                });
            }
            
            console.log('Final timeSlots:', timeSlots);
            return timeSlots;
        }
        
        // Test cases
        const testCases = [
            "Mo 9 - 12",
            "Fr 13 - 16", 
            "Mo 12 - 15 Th 17 - 18",
            "Tu 14 - 17",
            "We 10 - 13"
        ];
        
        const output = document.getElementById('output');
        
        testCases.forEach(testCase => {
            const result = parseExcelTime(testCase);
            output.innerHTML += `<p><strong>${testCase}</strong>: ${JSON.stringify(result, null, 2)}</p>`;
        });
        
        // Test the sample data
        const sampleLectures = [
            { Code: "CS101", Name: "Introduction to Computer Science", Lecturer: "Dr. Smith", Hours: "3", Section: "01", ExcelTime: "Mo 9 - 12" },
            { Code: "CS101", Name: "Introduction to Computer Science", Lecturer: "Dr. Smith", Hours: "3", Section: "02", ExcelTime: "Tu 14 - 17" },
            { Code: "ENG102", Name: "English Composition", Lecturer: "Ms. Davis", Hours: "4", Section: "01", ExcelTime: "Mo 10 - 12 Th 10 - 12" }
        ];
        
        console.log('Testing sample lectures:');
        sampleLectures.forEach(lecture => {
            console.log(`Testing ${lecture.Code} - ${lecture.ExcelTime}`);
            const result = parseExcelTime(lecture.ExcelTime);
            console.log('Result:', result);
        });
    </script>
</body>
</html>